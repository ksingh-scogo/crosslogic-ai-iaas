# ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
# ‚ïë  CrossLogic AI IaaS - Environment Configuration               ‚ïë
# ‚ïë  Copy this file to .env in root directory and fill values     ‚ïë
# ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

# =================================================================
# üîê SECURITY (REQUIRED - MUST BE SET)
# =================================================================

# Database password (REQUIRED)
# Used by PostgreSQL containers and control plane
DB_PASSWORD=your_secure_password_here_minimum_16_chars

# Admin API Token (REQUIRED)
# Used to authenticate admin operations and dashboard access
# Generate with: openssl rand -hex 32
ADMIN_API_TOKEN=your_admin_token_minimum_32_chars

# JWT Secret (REQUIRED)
# Used for signing JWT tokens and dashboard authentication
# Generate with: openssl rand -hex 32
JWT_SECRET=your_jwt_secret_minimum_32_characters_long

# =================================================================
# ‚òÅÔ∏è  CLOUDFLARE R2 (REQUIRED FOR MODEL STORAGE)
# =================================================================

# R2 Endpoint (REQUIRED)
# Get from Cloudflare R2 dashboard
# Format: https://<account-id>.r2.cloudflarestorage.com
R2_ENDPOINT=https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com

# R2 Bucket Name
# Default: crosslogic-models
R2_BUCKET=crosslogic-models

# R2 Access Credentials (REQUIRED)
# Generate from Cloudflare R2 ‚Üí Manage R2 API Tokens
R2_ACCESS_KEY=your_r2_access_key_here
R2_SECRET_KEY=your_r2_secret_key_here

# R2 CDN Domain (Optional)
# If you've configured a custom domain for R2
# Example: models.yourdomain.com
R2_CDN_DOMAIN=

# =================================================================
# ‚ö° VLLM RUN:AI STREAMER (OPTIONAL - FOR ULTRA-FAST LOADING)
# =================================================================

# Enable Run:ai Model Streamer (default: true)
# Reduces model load time from 30-60s to 4-23s
# Requires: vLLM >= 0.6.6 with [runai] extras, safetensors format models
VLLM_USE_RUNAI_STREAMER=true

# Concurrent threads for parallel streaming (default: 32)
# Range: 8-64 (higher = faster, more bandwidth usage)
# Recommendations:
#   - 7B-13B models: 16-32
#   - 30B-40B models: 32-48
#   - 70B+ models: 48-64
VLLM_STREAMER_CONCURRENCY=32

# Memory buffer size in bytes (default: 5GB = 5368709120)
# Increase for larger models (e.g., 70B models use 10GB = 10737418240)
# Rule of thumb: ~1GB per 10B parameters
VLLM_STREAMER_MEMORY_LIMIT=5368709120

# GPU memory utilization (default: 0.95)
# Run:ai Streamer is more efficient than standard loading, can use 0.95 safely
# Standard loading uses 0.90
VLLM_GPU_MEMORY_UTIL=0.95

# =================================================================
# ü§ó HUGGINGFACE (REQUIRED FOR MODEL DOWNLOADS)
# =================================================================

# HuggingFace Token (REQUIRED for downloading models)
# Get from: https://huggingface.co/settings/tokens
# Needs: read access to repos
HUGGINGFACE_TOKEN=hf_your_token_here

# =================================================================
# ‚òÅÔ∏è  CLOUD PROVIDERS (AT LEAST ONE REQUIRED FOR GPU INSTANCES)
# =================================================================

# --- AWS Credentials (for SkyPilot) ---
# Required if using AWS for GPU instances
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_DEFAULT_REGION=us-east-1

# --- Azure Credentials (for SkyPilot) ---
# Required if using Azure for GPU instances
AZURE_SUBSCRIPTION_ID=your_azure_subscription_id
AZURE_TENANT_ID=your_azure_tenant_id
# Azure uses browser-based auth, so no client_id/secret typically needed

# --- GCP Credentials (for SkyPilot) ---
# Required if using GCP for GPU instances
# Set path to your service account JSON file
GCP_PROJECT_ID=your_gcp_project_id
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json

# =================================================================
# üí≥ STRIPE BILLING (OPTIONAL - FOR PRODUCTION)
# =================================================================

# Enable/disable billing
# Set to false for development/testing
BILLING_ENABLED=false

# Stripe API Keys
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_stripe_test_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Billing intervals
# How often to aggregate usage and export to Stripe
BILLING_AGGREGATION_INTERVAL=1h
BILLING_EXPORT_INTERVAL=5m

# =================================================================
# üñ•Ô∏è  SERVER CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# Server host and port
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# Public URL for node agent registration
# Use your production domain in production
CONTROL_PLANE_URL=http://localhost:8080

# Server timeouts
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s

# =================================================================
# üóÑÔ∏è  DATABASE CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# PostgreSQL connection
DB_HOST=postgres
DB_PORT=5432
DB_USER=crosslogic
DB_NAME=crosslogic_iaas
DB_SSL_MODE=disable

# Connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# =================================================================
# üî¥ REDIS CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# Redis connection
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10

# =================================================================
# üîí TLS/SSL CONFIGURATION (OPTIONAL - FOR PRODUCTION)
# =================================================================

# Enable TLS
TLS_ENABLED=false

# TLS certificate paths (if TLS_ENABLED=true)
TLS_CERT_PATH=/path/to/cert.pem
TLS_KEY_PATH=/path/to/key.pem

# =================================================================
# üéÆ RUNTIME CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# vLLM version to use on GPU nodes
VLLM_VERSION=0.6.2

# PyTorch version to use on GPU nodes
TORCH_VERSION=2.4.0

# =================================================================
# üìä MONITORING CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# Enable monitoring
MONITORING_ENABLED=true

# Prometheus metrics
PROMETHEUS_PORT=9090
METRICS_PATH=/metrics

# Logging level
# Options: debug, info, warn, error
LOG_LEVEL=info

# =================================================================
# üîê SECURITY CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# API key hash rounds (bcrypt)
# Higher = more secure but slower
API_KEY_HASH_ROUNDS=12

# =================================================================
# üìä GRAFANA (OPTIONAL - FOR VISUALIZATION)
# =================================================================

# Grafana admin password
GRAFANA_PASSWORD=admin

# =================================================================
# üåê DASHBOARD CONFIGURATION (OPTIONAL - HAS DEFAULTS)
# =================================================================

# Dashboard API base URL (for Docker internal communication)
CROSSLOGIC_API_BASE_URL=http://control-plane:8080

# Dashboard admin token (same as ADMIN_API_TOKEN)
CROSSLOGIC_ADMIN_TOKEN=${ADMIN_API_TOKEN}

# NextAuth configuration
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=${JWT_SECRET}

# =================================================================
# üìù NOTES
# =================================================================

# 1. REQUIRED VARIABLES:
#    - DB_PASSWORD
#    - ADMIN_API_TOKEN
#    - JWT_SECRET
#    - R2_ENDPOINT
#    - R2_ACCESS_KEY
#    - R2_SECRET_KEY
#    - HUGGINGFACE_TOKEN
#    - At least one cloud provider (AWS, Azure, or GCP)

# 2. GENERATE SECRETS:
#    openssl rand -hex 32

# 3. CLOUD CREDENTIALS:
#    - You need credentials for at least one cloud provider
#    - SkyPilot will use these to provision GPU instances
#    - Can configure multiple providers for multi-cloud

# 4. BILLING:
#    - Set BILLING_ENABLED=false for development
#    - Set BILLING_ENABLED=true for production with Stripe

# 5. MODEL STORAGE:
#    - R2 is used for fast model loading with zero egress fees
#    - vLLM streams directly from R2 using S3-compatible API
#    - No additional setup needed after uploading models

# 6. TESTING:
#    - For local testing, use default values
#    - Only DB_PASSWORD, tokens, and R2 credentials are required
#    - Billing can be disabled

# 7. PRODUCTION:
#    - Use strong passwords (16+ chars)
#    - Enable TLS
#    - Set proper CONTROL_PLANE_URL
#    - Enable billing with Stripe
#    - Use production cloud credentials

# =================================================================
# üöÄ QUICK START
# =================================================================

# 1. Copy this file:
#    cp config/env.example .env

# 2. Generate secrets:
#    export ADMIN_TOKEN=$(openssl rand -hex 32)
#    export JWT_SECRET=$(openssl rand -hex 32)

# 3. Edit .env and set:
#    - DB_PASSWORD
#    - ADMIN_API_TOKEN (use $ADMIN_TOKEN)
#    - JWT_SECRET (use $JWT_SECRET)
#    - R2_ENDPOINT, R2_ACCESS_KEY, R2_SECRET_KEY
#    - HUGGINGFACE_TOKEN
#    - Cloud credentials (AWS, Azure, or GCP)

# 4. Start services:
#    ./start.sh

# 5. Access dashboard:
#    http://localhost:3000

# =================================================================
# üìö DOCUMENTATION
# =================================================================

# - START_HERE.md - Main entry point
# - QUICK_START.md - 5-minute setup
# - UPDATED_LOCAL_SETUP.md - Complete guide
# - PREREQUISITES_CHECKLIST.md - What you need

# =================================================================


